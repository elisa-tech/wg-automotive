digraph G {

node [shape=box width=1 height=0.5 fontname=arial fontsize=16 style=filled fillcolor=white]
graph [splines=ortho ranksep=1 nodesep=0.2 fontname=arial fontsize=16 compound=true]

handler [label="Request Handler" width=6]
render [label="Rendering (Qt)" width=3]
dcontrol [label="Display controller"]
display [label="Display" width=6]
kernel [label="Linux kernel" width=9]
check [label="Telltale checking" width=3]
watchdog [label="Watchdog"]
requester [label="Telltale requester"]
state [label="Vehicle state source"]
cluster [label="Cluster App" width=3]

requester -> handler [taillabel="\rSet telltale status  \r(CAN bus?)  \r"]
state -> cluster [taillabel="\rSend state info  \r(CAN bus?)  \r"]
cluster -> render [taillabel="\rRender  \r(IPC)  \r" weight=2]
cluster -> kernel [taillabel="\rSetup IPC  \r"]
dcontrol -> display [taillabel="\rRender  \r"]
handler -> kernel [taillabel="\rSetup IPC  \r"]
handler -> check [taillabel="\rSet required telltales  \r(IPC)  \r"]
handler -> render [taillabel="\lRender  \r(IPC)  \r"]
render -> kernel [taillabel="\rConfigure image  \rbuffer address  \r"]
kernel -> dcontrol [taillabel="\rConfigure image  \rbuffer address  \r"]
check -> kernel [taillabel="\rConfigure watchdog  \r\rPet watchdog  \r"]
check -> kernel [dir=back style=dashed color=red]
kernel -> watchdog [taillabel="\rPet  \r"]
watchdog -> display [taillabel="\rTurn off backlight  \r"]
kernel -> display [dir=back style=dashed color=red]
}
